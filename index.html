<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpiceRoute | Premium Masalas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Outfit', sans-serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-[#fdfcfb] text-stone-900">

<div id="login-modal" class="fixed inset-0 bg-stone-900/60 backdrop-blur-md z-[100] flex items-center justify-center p-4">
    <div class="bg-white p-8 rounded-[2.5rem] max-w-sm w-full shadow-2xl text-center border border-stone-100">
        <div class="text-4xl mb-4">ðŸŒ¿</div>
        <h2 class="text-2xl font-extrabold mb-2 text-stone-900">Welcome to SpiceRoute</h2>
        <p class="text-sm text-stone-500 mb-8">Enter your details to enter the store.</p>
        <div class="flex gap-2 mb-4">
            <input id="login-area-code" type="text" value="+91" class="w-1/3 p-4 bg-stone-50 border border-stone-200 rounded-2xl text-center outline-none">
            <input id="login-phone-input" type="tel" placeholder="Phone Number" class="w-2/3 p-4 bg-stone-50 border border-stone-200 rounded-2xl text-center outline-none">
        </div>
        <button onclick="handleLogin()" class="w-full bg-orange-600 text-white py-4 rounded-2xl font-bold text-lg hover:bg-orange-700 active:scale-95 transition-all">Start Shopping</button>
    </div>
</div>

<nav class="bg-white/80 backdrop-blur-md border-b border-stone-100 p-4 sticky top-0 z-50">
    <div class="container mx-auto max-w-5xl flex justify-between items-center">
        <div>
            <h1 class="text-2xl font-black uppercase tracking-tighter text-orange-600 cursor-pointer" onclick="location.reload()">SpiceRoute</h1>
            <p id="user-display" class="text-[9px] font-bold text-stone-400 tracking-widest uppercase"></p>
        </div>
        <div class="flex items-center gap-4">
            <button onclick="toggleHistory()" class="text-sm font-bold text-stone-500 hover:text-stone-900">My Orders</button>
            <button onclick="toggleCart()" class="bg-stone-900 text-white px-6 py-2.5 rounded-full font-bold flex items-center gap-2 transition-transform active:scale-90">
                Cart <span id="cart-count" class="bg-orange-500 text-[10px] w-5 h-5 flex items-center justify-center rounded-full">0</span>
            </button>
        </div>
    </div>
</nav>

<main class="container mx-auto px-4 py-12 max-w-4xl">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div class="bg-white p-8 rounded-[2.5rem] shadow-sm border border-stone-100 hover:shadow-xl transition-all">
            <div class="h-40 bg-orange-50 rounded-3xl mb-6 flex items-center justify-center text-5xl">ðŸ”¥</div>
            <h3 class="text-xl font-extrabold">Garam Masala</h3>
            <p class="text-3xl font-black text-stone-900 my-4">â‚¹100</p>
            <button onclick="addToCart('Garam Masala', 100)" class="w-full bg-stone-900 text-white py-3.5 rounded-2xl font-bold hover:bg-orange-600 transition-all">Add to Cart</button>
        </div>
        <div class="bg-white p-8 rounded-[2.5rem] shadow-sm border border-stone-100 hover:shadow-xl transition-all">
            <div class="h-40 bg-yellow-50 rounded-3xl mb-6 flex items-center justify-center text-5xl">âœ¨</div>
            <h3 class="text-xl font-extrabold">Special Masala</h3>
            <p class="text-3xl font-black text-stone-900 my-4">â‚¹80</p>
            <button onclick="addToCart('Special Masala', 80)" class="w-full bg-stone-900 text-white py-3.5 rounded-2xl font-bold hover:bg-orange-600 transition-all">Add to Cart</button>
        </div>
    </div>
</main>

<div id="checkout-modal" class="fixed inset-0 bg-stone-900/60 backdrop-blur-sm hidden flex items-center justify-center p-4 z-[110]">
    <div class="bg-white p-10 rounded-[2.5rem] max-w-md w-full shadow-2xl">
        <h2 class="text-2xl font-black mb-6">Complete Order</h2>
        <div id="cart-items" class="mb-4 space-y-2 text-sm"></div>
        <div id="cart-total-display" class="border-t pt-4 mb-6"></div>
        <form onsubmit="initiatePayment(event)" class="space-y-4">
            <input required id="cust-name" placeholder="Full Name" class="w-full p-4 bg-stone-50 border border-stone-100 rounded-2xl outline-none">
            <input required id="cust-addr" placeholder="Shipping Address" class="w-full p-4 bg-stone-50 border border-stone-100 rounded-2xl outline-none">
            <button type="submit" class="w-full bg-green-600 text-white py-5 rounded-2xl font-bold text-lg shadow-lg">PAY VIA GOOGLE PAY</button>
            <button type="button" onclick="toggleCart()" class="w-full text-stone-400 text-xs font-bold uppercase tracking-widest py-2">Go Back</button>
        </form>
    </div>
</div>

<div id="history-drawer" class="fixed inset-0 bg-stone-900/60 backdrop-blur-sm hidden z-[120] flex justify-end">
    <div class="bg-white w-full md:max-w-md h-full p-8 shadow-2xl overflow-y-auto no-scrollbar">
        <div class="flex justify-between items-center mb-8">
            <h2 class="text-2xl font-black">My Orders</h2>
            <button onclick="toggleHistory()" class="text-stone-400 text-3xl hover:text-stone-900">&times;</button>
        </div>
        <div id="history-list" class="space-y-6"></div>
    </div>
</div>

<script>
let cart = [];
let fullUserPhone = "";
const MY_GPAY_ID = "sharayuj66@oksbi";
const ADMIN_PHONE = "919029523782"; 

function handleLogin() {
    const code = document.getElementById('login-area-code').value;
    const phone = document.getElementById('login-phone-input').value;
    if(phone.length > 5) {
        fullUserPhone = (code || "+91").replace(/\s/g, '') + phone;
        localStorage.setItem('spiceRoute_User', fullUserPhone);
        document.getElementById('login-modal').classList.add('hidden');
        updateUserUI();
    }
}

function updateUserUI() {
    document.getElementById('user-display').innerText = "Logged: " + fullUserPhone;
    renderHistory();
}

function addToCart(name, price) {
    cart.push({ name, price });
    document.getElementById('cart-count').innerText = cart.length;
}

function toggleCart() {
    if (cart.length === 0) { alert("Cart is empty!"); return; }
    const itemsDiv = document.getElementById('cart-items');
    const totalDiv = document.getElementById('cart-total-display');
    let total = cart.reduce((s, i) => s + i.price, 0);
    itemsDiv.innerHTML = cart.map(i => `<div class="flex justify-between"><span>${i.name}</span><b>â‚¹${i.price}</b></div>`).join('');
    totalDiv.innerHTML = `<div class="flex justify-between text-xl font-black"><span>Total</span><span class="text-orange-600">â‚¹${total}</span></div>`;
    document.getElementById('checkout-modal').classList.toggle('hidden');
}

function toggleHistory() {
    renderHistory();
    document.getElementById('history-drawer').classList.toggle('hidden');
}

function renderHistory() {
    const list = document.getElementById('history-list');
    const orders = JSON.parse(localStorage.getItem('orders_' + fullUserPhone)) || [];
    
    list.innerHTML = orders.length ? orders.reverse().map(o => `
        <div class="p-6 rounded-[2rem] bg-stone-50 border border-stone-100 shadow-sm">
            <div class="flex justify-between items-center mb-4">
                <span class="text-[10px] font-bold text-orange-600 tracking-tighter uppercase">${o.id}</span>
                <span class="text-[10px] font-bold px-2 py-0.5 bg-orange-100 text-orange-700 rounded-full uppercase">${o.status}</span>
            </div>
            <p class="text-sm font-bold text-stone-800 mb-1">${o.items}</p>
            <p class="text-[10px] text-stone-400 mb-4">${o.date}</p>
            
            <div class="bg-white p-4 rounded-2xl border border-stone-200 mb-4">
                <p class="text-[9px] font-bold text-stone-400 uppercase tracking-widest mb-1">Live Tracking</p>
                <p class="text-xs font-bold text-stone-700">ðŸš€ ${o.tracking}</p>
            </div>

            <div class="flex justify-between items-center pt-2 border-t border-stone-200">
                <span class="text-xl font-black">${o.total}</span>
                <div class="flex gap-2">
                    <a href="tel:${ADMIN_PHONE}" class="p-2 bg-stone-200 rounded-full text-lg shadow-sm">ðŸ“ž</a>
                    <a href="https://wa.me/${ADMIN_PHONE}?text=Query Order ${o.id}" class="p-2 bg-green-100 rounded-full text-lg shadow-sm">ðŸ’¬</a>
                </div>
            </div>
        </div>
    `).join('') : '<div class="text-center py-20 text-stone-400 italic">No orders found.</div>';
}

function initiatePayment(e) {
    e.preventDefault();
    const total = cart.reduce((s, i) => s + i.price, 0);
    const orderID = 'SR-' + Math.floor(1000 + Math.random() * 9000);

    const upiParams = `pa=${MY_GPAY_ID}&pn=SpiceRoute&am=${total}&cu=INR&tn=Order-${orderID}&mc=0000&mode=02`;
    
    const orderData = {
        id: orderID,
        total: "â‚¹" + total,
        items: cart.map(i => i.name).join(", "),
        date: new Date().toLocaleDateString(),
        status: "Payment Pending",
        tracking: "Verifying payment...",
        customer: fullUserPhone
    };

    let history = JSON.parse(localStorage.getItem('orders_' + fullUserPhone)) || [];
    history.push(orderData);
    localStorage.setItem('orders_' + fullUserPhone, JSON.stringify(history));

    window.location.href = `upi://pay?${upiParams}`;

    setTimeout(() => {
        document.getElementById('checkout-modal').classList.add('hidden');
        cart = [];
        document.getElementById('cart-count').innerText = "0";
        toggleHistory();
    }, 1000);
}

window.onload = () => {
    const saved = localStorage.getItem('spiceRoute_User');
    if(saved) {
        fullUserPhone = saved;
        document.getElementById('login-modal').classList.add('hidden');
        updateUserUI();
    }
};
</script>
</body>
</html>
